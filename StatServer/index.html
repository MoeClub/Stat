<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>服务器状态</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,viewport-fit=cover">
    <style>
        :root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0 !important}hr{box-sizing:content-box;height:0;overflow:visible}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}abbr[data-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;cursor:help;border-bottom:0;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700} li{list-style-type: none;} dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]):not([class]){color:inherit;text-decoration:none}a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto;-ms-overflow-style:scrollbar}figure{margin:0 0 1rem}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}caption{padding-top:.75rem;padding-bottom:.75rem;color:#6c757d;text-align:left;caption-side:bottom}th{text-align:inherit;text-align:-webkit-match-parent}label{display:inline-block;margin-bottom:.5rem}button{border-radius:0}button:focus{outline:1px dotted}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}textarea{overflow:auto;resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;max-width:100%;padding:0;margin-bottom:.5rem;font-size:1.5rem;line-height:inherit;color:inherit;white-space:normal}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}summary{display:list-item;cursor:pointer}template{display:none}[hidden]{display:none !important}hr{margin-top:1rem;margin-bottom:1rem;border:0;border-top:1px solid rgba(0,0,0,.1)}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:87.5%;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:100%;font-weight:700}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.row-cols-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}@media(min-width:576px){.row-cols-sm-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-sm-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-sm-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-sm-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-sm-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-sm-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}}@media(min-width:768px){.row-cols-md-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-md-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-md-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-md-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-md-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-md-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}}@media(min-width:992px){.row-cols-lg-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-lg-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-lg-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-lg-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-lg-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-lg-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}}@media(min-width:1200px){.row-cols-xl-1>*{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.row-cols-xl-2>*{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.row-cols-xl-3>*{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.row-cols-xl-4>*{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.row-cols-xl-5>*{-ms-flex:0 0 20%;flex:0 0 20%;max-width:20%}.row-cols-xl-6>*{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}}.table td,.table th{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6}.table tbody+tbody{border-top:2px solid #dee2e6}.table-sm td,.table-sm th{padding:.3rem}.table-bordered td,.table-bordered th{border:1px solid #dee2e6}.table-bordered thead td,.table-bordered thead th{border-bottom-width:2px}.table-borderless tbody+tbody,.table-borderless td,.table-borderless th,.table-borderless thead th{border:0}.table-striped tbody tr:nth-of-type(odd){background-color:rgba(0,0,0,.05)}.table-hover tbody tr:hover{color:#212529;background-color:rgba(0,0,0,.075)}.table-primary tbody+tbody,.table-primary td,.table-primary th,.table-primary thead th{border-color:#7abaff}.table-hover.table-primary:hover>td,.table-hover.table-primary:hover>th{background-color:#9fcdff}.table-secondary tbody+tbody,.table-secondary td,.table-secondary th,.table-secondary thead th{border-color:#b3b7bb}.table-hover.table-secondary:hover>td,.table-hover.table-secondary:hover>th{background-color:#c8cbcf}.table-success tbody+tbody,.table-success td,.table-success th,.table-success thead th{border-color:#8fd19e}.table-hover.table-success:hover>td,.table-hover.table-success:hover>th{background-color:#b1dfbb}.table-info tbody+tbody,.table-info td,.table-info th,.table-info thead th{border-color:#86cfda}.table-hover.table-info:hover>td,.table-hover.table-info:hover>th{background-color:#abdde5}.table-warning tbody+tbody,.table-warning td,.table-warning th,.table-warning thead th{border-color:#ffdf7e}.table-hover.table-warning:hover>td,.table-hover.table-warning:hover>th{background-color:#ffe8a1}.table-danger tbody+tbody,.table-danger td,.table-danger th,.table-danger thead th{border-color:#ed969e}.table-hover.table-danger:hover>td,.table-hover.table-danger:hover>th{background-color:#f1b0b7}.table-light tbody+tbody,.table-light td,.table-light th,.table-light thead th{border-color:#fbfcfc}.table-hover.table-light:hover>td,.table-hover.table-light:hover>th{background-color:#ececf6}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#95999c}.table-hover.table-dark:hover>td,.table-hover.table-dark:hover>th{background-color:#b9bbbe}.table-hover.table-active:hover>td,.table-hover.table-active:hover>th{background-color:rgba(0,0,0,.075)}.table.thead-dark th{color:#fff;background-color:#343a40;border-color:#454d55}.table.thead-light th{color:#495057;background-color:#e9ecef;border-color:#dee2e6}.table-dark td,.table-dark th,.table-dark thead th{border-color:#454d55}.table-dark.table-striped tbody tr:nth-of-type(odd){background-color:rgba(255,255,255,.05)}.table-dark.table-hover tbody tr:hover{color:#fff;background-color:rgba(255,255,255,.075)}@media(min-width:576px){.form-inline label{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;margin-bottom:0}}.btn-group-toggle>.btn input[type=checkbox],.btn-group-toggle>.btn input[type=radio],.btn-group-toggle>.btn-group>.btn input[type=checkbox],.btn-group-toggle>.btn-group>.btn input[type=radio]{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.input-group-text input[type=checkbox],.input-group-text input[type=radio]{margin-top:0}.navbar-light.navbar-text a{color:rgba(0,0,0,.9)}.navbar-light.navbar-text a:focus,.navbar-light.navbar-text a:hover{color:rgba(0,0,0,.9)}.navbar-dark.navbar-text a{color:#fff}.navbar-dark.navbar-text a:focus,.navbar-dark.navbar-text a:hover{color:#fff}.card{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-width:0;word-wrap:break-word;background-color:#fff;background-clip:border-box;border:1px solid rgba(0,0,0,.125);border-radius:.25rem}.card>hr{margin-right:0;margin-left:0}.card-body{-ms-flex:1 1 auto;flex:1 1 auto;min-height:1px;padding:1rem 1.25rem 0 1.25rem}.card-header{padding:.75rem 1.25rem;margin-bottom:0;background-color:rgba(0,0,0,.03);border-bottom:1px solid rgba(0,0,0,.125)}.card-header:first-child{border-radius:calc(.25rem-1px) calc(.25rem-1px) 0 0}.card-group>.card{margin-bottom:15px}@media(min-width:576px){.card-group>.card{-ms-flex:1 0 0;flex:1 0 0;margin-bottom:0}.card-group>.card+.card{margin-left:0;border-left:0}.card-group>.card:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group>.card:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}}.accordion>.card{overflow:hidden}.accordion>.card:not(:last-of-type){border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0}.accordion>.card:not(:first-of-type){border-top-left-radius:0;border-top-right-radius:0}.accordion>.card>.card-header{border-radius:0;margin-bottom:-1px}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}.progress{display:-ms-flexbox;display:flex;height:1rem;overflow:hidden;line-height:0;font-size:.75rem;background-color:#e9ecef;border-radius:.25rem}.progress-bar{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;overflow:hidden;color:#fff;text-align:center;white-space:nowrap;background-color:#007bff;transition:width .6s ease}@media(prefers-reduced-motion:reduce){.progress-bar{transition:none}}.modal-footer>*{margin:.25rem}.carousel-indicators li{box-sizing:content-box;-ms-flex:0 1 auto;flex:0 1 auto;width:30px;height:3px;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;transition:opacity .6s ease}@media(prefers-reduced-motion:reduce){.carousel-indicators li{transition:none}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1;-webkit-transform:none;transform:none}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1;-webkit-transform:none;transform:none}}@media(min-width:576px){.d-sm-none{display:none}}@media(min-width:768px){.d-md-block{display:block}}@media print{.d-print-none{display:none}.d-print-inline{display:inline !important}.d-print-inline-block{display:inline-block !important}.d-print-block{display:block !important}.d-print-table{display:table !important}.d-print-table-row{display:table-row !important}.d-print-table-cell{display:table-cell !important}.d-print-flex{display:-ms-flexbox !important;display:flex !important}.d-print-inline-flex{display:-ms-inline-flexbox !important;display:inline-flex !important}}@media print{*,::after,::before{text-shadow:none !important;box-shadow:none !important}a:not(.btn){text-decoration:underline}abbr[title]::after{content:" (" attr(title) ")"}pre{white-space:pre-wrap !important}blockquote,pre{border:1px solid #adb5bd;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}body{min-width:992px !important}.container{min-width:992px !important}.navbar{display:none}.badge{border:1px solid #000}.table{border-collapse:collapse !important}.table td,.table th{background-color:#fff !important}.table-bordered td,.table-bordered th{border:1px solid #dee2e6 !important}.table-dark{color:inherit}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#dee2e6}.table.thead-dark th{color:inherit;border-color:#dee2e6}}@media(min-width:1440px){.container{max-width:1440px}}@media(min-width:769px){.single{margin:10px auto !important;-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 48%;max-width:48%}}body{padding:20px;background:#f5f5f5;transition:all .3s ease}.container{margin:0 auto;padding:0}.card{margin:10px;border-radius:10px;box-shadow:0 8px 16px 0 rgba(0,0,0,0.2);transition:.3s;animation:slideIn 1s ease-out}.card:hover{box-shadow:0 12px 20px 0 rgba(0,0,0,0.3)}.card-header{font-size:1.3rem;font-weight:bold;color:#333;background:#e9ecef;border-bottom:0}.card-body p,.card-body div{font-size:1rem;color:#666;transition:all .3s ease}.mem-total{margin-bottom:1rem}.card-body span{font-weight:bold;color:#333;transition:color .3s ease}@keyframes slideIn{from{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}@media(max-width:768px){.card{width: 90%;margin: 10px auto;}.card-header{font-size:1.2em}.card-body p{font-size:1em}}  .card-body > p, .card-body > div {display: none;transition: opacity 0.5s ease, height 0.5s ease;}  .card-body > p:nth-child(1), .card-body > p:nth-child(2) {display: block;}
    </style>
</head>
<body>
<div class="container">
    <div class="row" id="serverRow"></div>
</div>
<script>
    const SEC_IN_HOUR = 60 * 60;
    const SEC_IN_DAY = 24 * SEC_IN_HOUR;
    const SHOW_TYPE = 'slide'; //显示方式 click、slide
    const TPL = `
        <div class="col-lg-6 col-xs-12 card" id="{{suffix}}">
            <div class="card-header">
                主机 <span id="HostName{{suffix}}"></span> 的状态
            </div>
            <div class="card-body">
                <p>IP 地址: <span id="IPAddr{{suffix}}"></span> <span id="Online{{suffix}}"></span></p>
                <p>运行时间: <span id="Uptime{{suffix}}"></span></p>
                <p>处理器信息:  <span id="CPUModel{{suffix}}"></span> </p>
                <p>核心数量: <span id="CoreNum{{suffix}}"></span></p>
                <div class="mem-total">总内存: <span id="MemTotal{{suffix}}"></span>  可用内存: <span id="MemAvailable{{suffix}}"></span>  进程内存: <span id="MemProc{{suffix}}"></span>
                    <div class="progress">
                        <div class="progress-bar" id="MemProgress{{suffix}}" role="progressbar" style="width: 0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
                <p>负载: <span id="Load{{suffix}}"></span></p>
                <p>网络状况: <span id="Network{{suffix}}"></span></p>
                <p>流量统计: <span id="NetworkRT{{suffix}}"></span></p>
                <p>磁盘: <span id="Disks{{suffix}}"></span></p>
                <p>报告时间: <span id="ReportTime{{suffix}}"></span></p>
                <p>延迟: <span id="Ping{{suffix}}"></span></p>
                <p>主机: <span id="PingHost{{suffix}}"></span></p>
                <p class="d-md-block d-sm-none">上一个命令: <span id="CMDPrev{{suffix}}"></span></p>
                <p class="d-md-block d-sm-none">报告客户端: <span id="ReportClient{{suffix}}"></span></p>
            </div>
        </div>`

    const cpuVendor = {
        "0x41": "ARM",
        "0x42": "Broadcom",
        "0x43": "Cavium",
        "0x44": "DEC",
        "0x46": "Fujitsu",
        "0x48": "HiSilicon",
        "0x49": "Infineon",
        "0x4d": "Motorola/Freescale",
        "0x4e": "NVIDIA",
        "0x50": "APM",
        "0x51": "Qualcomm",
        "0x56": "Marvell",
        "0x61": "Apple",
        "0x69": "Intel",
        "0xc0": "Ampere"
    };

    const cpuPart = {
        "0x810": "ARM810",
        "0x920": "ARM920",
        "0x922": "ARM922",
        "0x926": "ARM926",
        "0x940": "ARM940",
        "0x946": "ARM946",
        "0x966": "ARM966",
        "0xa20": "ARM1020",
        "0xa22": "ARM1022",
        "0xa26": "ARM1026",
        "0xb02": "ARM11 MPCore",
        "0xb36": "ARM1136",
        "0xb56": "ARM1156",
        "0xb76": "ARM1176",
        "0xc05": "Cortex-A5",
        "0xc07": "Cortex-A7",
        "0xc08": "Cortex-A8",
        "0xc09": "Cortex-A9",
        "0xc0d": "Cortex-A17",
        "0xc0f": "Cortex-A15",
        "0xc0e": "Cortex-A17",
        "0xc14": "Cortex-R4",
        "0xc15": "Cortex-R5",
        "0xc17": "Cortex-R7",
        "0xc18": "Cortex-R8",
        "0xc20": "Cortex-M0",
        "0xc21": "Cortex-M1",
        "0xc23": "Cortex-M3",
        "0xc24": "Cortex-M4",
        "0xc27": "Cortex-M7",
        "0xc60": "Cortex-M0+",
        "0xd01": "Cortex-A32",
        "0xd02": "Cortex-A34",
        "0xd03": "Cortex-A53",
        "0xd04": "Cortex-A35",
        "0xd05": "Cortex-A55",
        "0xd06": "Cortex-A65",
        "0xd07": "Cortex-A57",
        "0xd08": "Cortex-A72",
        "0xd09": "Cortex-A73",
        "0xd0a": "Cortex-A75",
        "0xd0b": "Cortex-A76",
        "0xd0c": "Neoverse-N1",
        "0xd0d": "Cortex-A77",
        "0xd0e": "Cortex-A76AE",
        "0xd13": "Cortex-R52",
        "0xd20": "Cortex-M23",
        "0xd21": "Cortex-M33",
        "0xd40": "Neoverse-V1",
        "0xd41": "Cortex-A78",
        "0xd42": "Cortex-A78AE",
        "0xd43": "Cortex-A65AE",
        "0xd44": "Cortex-X1",
        "0xd46": "Cortex-A510",
        "0xd47": "Cortex-A710",
        "0xd48": "Cortex-X2",
        "0xd49": "Neoverse-N2",
        "0xd4a": "Neoverse-E1",
        "0xd4b": "Cortex-A78C",
        "0xd4c": "Cortex-X1C",
        "0xd4d": "Cortex-A715",
        "0xd4e": "Cortex-X3"
    };

    let showAllElements = (element) => {
        element.style.display = 'block';
        setTimeout(() => {
            element.style.opacity = '1';
        }, 10);
    }

    let hideSomeElements = (element) => {
        element.style.opacity = '0';
        setTimeout(() => {
            if (element.style.opacity === '0') {
                element.style.display = 'none';
            }
        }, 800);
    }

    function convertKBtoGBorMB(kb, fixed = 2) {
        const gb = kb / (1024 * 1024);
        return gb < 1 ? `${(kb / 1024).toFixed(fixed)} MB` : `${gb.toFixed(fixed)} GB`;
    }

    function formatTimestamp(timestamp) {
        let date = new Date(timestamp * 1000);
        let year = date.getFullYear();
        let month = ("0" + (date.getMonth() + 1)).slice(-2);
        let day = ("0" + date.getDate()).slice(-2);
        let hours = ("0" + date.getHours()).slice(-2);
        let minutes = ("0" + date.getMinutes()).slice(-2);
        let seconds = ("0" + date.getSeconds()).slice(-2);
        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
    }

    function convertSeconds(sec) {
        const days = Math.floor(sec / SEC_IN_DAY);
        sec %= SEC_IN_DAY;
        const hours = Math.floor(sec / SEC_IN_HOUR);
        sec %= SEC_IN_HOUR;
        const minutes = Math.floor(sec / 60);
        sec %= 60;
        const seconds = Math.floor(sec);
        return `${days}天${hours}时${minutes}分${seconds}秒`;
    }

    function getName(code, type) {
        const lookup = type === 'vendor' ? cpuVendor : cpuPart;
        return code.indexOf('0x') > -1 ? lookup[code] || "Unknown" : code;
    }

    const keyFuncs = {
        'Uptime': convertSeconds,
        'MemProc': convertKBtoGBorMB,
        'ReportTime': formatTimestamp,
        'Ping': value => `${value} ms`,
        'CPUModel': value => `${getName(value['Name'], 'Name')} ${getName(value['Vendor'], 'vendor')}`,
        'Online': value => `${value ? ' <b style="color: green"> 在线 </b>' : ' <b style="color: red"> 离线 </b>'}`,
        'Network': value => `↓${(value[0] / 1024).toFixed(2)}K/s ↑${(value[1] / 1024).toFixed(2)}K/s`,
        'NetworkRT': value => `入网 ${convertKBtoGBorMB((value[0] / 1024).toFixed(2))} 出网 ${convertKBtoGBorMB((value[1] / 1024).toFixed(2))}`,
        'MemTotal': (value, suffix) => {
            let formatted = convertKBtoGBorMB(value);
            document.getElementById('MemTotal' + suffix).innerText = formatted;
            return formatted
        },
        'MemAvailable': (value, suffix) => {
            let formatted = convertKBtoGBorMB(value);
            document.getElementById('MemAvailable' + suffix).innerText = formatted;
            let memTotal = parseFloat(document.getElementById('MemTotal' + suffix).innerText);
            const MemProgress = document.getElementById('MemProgress' + suffix),
                width = (((memTotal - parseFloat(formatted)) / memTotal) * 100).toFixed(2) + '%';
            MemProgress.style.width = width
            MemProgress.title = `使用率${width}`
            return formatted
        },
        'Disks': value => {
            let disks = '';
            for (let x in value) {
                if (x.indexOf('mappera') === -1) {
                    const width = (((value[x][0] - value[x][1]) / value[x][0]) * 100).toFixed(2) + '%';
                    disks += `<li>分区: ${x}， 总空间 ${convertKBtoGBorMB(value[x][0] / 1024, 0)}，剩余空间 ${convertKBtoGBorMB(value[x][1] / 1024, 0)}
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: ${width}" title="使用率${width}"></div>
                            </div>
                        </li>`;
                }
            }
            return disks.length > 0 ? `<ul>${disks}</ul>` : '';
        }
    }

    function updateServerStatus(suffix, serverData) {
        for (let key in serverData) {
            let value = serverData[key];
            if (Array.isArray(value) || typeof value === 'object') {
                value = JSON.parse(JSON.stringify(value));
            }
            if (keyFuncs.hasOwnProperty(key)) {
                value = keyFuncs[key](value, suffix);
            }
            let element = document.getElementById(key + suffix);
            if (element) {
                if (element.innerText !== value) {
                    element.classList.add('updated');
                    requestAnimationFrame(() => {
                        requestAnimationFrame(() => {
                            element.classList.remove('updated');
                        });
                    });
                }
                if (['Online', 'Disks'].includes(key)) {
                    element.innerHTML = value;
                } else {
                    element.innerText = value;
                }
            }

            const card = document.getElementById(suffix);
            if(SHOW_TYPE === 'slide'){
                card.onmouseover = function() {
                    // 显示所有的信息
                    Array.from(card.querySelectorAll('.card-body > p, .card-body > div')).forEach(showAllElements);
                };
                card.onmouseout = function() {
                    // 隐藏除了IP地址和运行时间以外的所有信息
                    Array.from(card.querySelectorAll('.card-body > p:not(:nth-child(1)):not(:nth-child(2)), .card-body > div')).forEach(hideSomeElements);
                };
            }else{
                card.onclick = function(event) {
                    event.stopPropagation(); // 阻止事件冒泡
                    // 显示所有的信息
                    Array.from(card.querySelectorAll('.card-body > p, .card-body > div')).forEach(showAllElements)
                };
            }
        }
    }

    function updateData() {
        fetch('?format=json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                const serverRow = document.getElementById('serverRow');
                // 创建一个服务器状态的缓存
                const serverStatusCache = {};
                let sortedData = Object.fromEntries(
                    Object.entries(data).sort(([,a], [,b]) => b.Online - a.Online)
                )
                for (const suffix in sortedData) {
                    if (!document.getElementById(suffix)) { // 如果服务器状态不存在，就创建它
                        serverRow.insertAdjacentHTML('beforeend', TPL.replace(/{{suffix}}/g, suffix));
                        if (Object.keys(data).length === 1) {
                            document.getElementById(suffix).classList.replace('col-lg-6', 'single')
                        }
                    }
                    // 更新服务器状态
                    updateServerStatus(suffix, data[suffix]);
                    // 将当前的服务器状态添加到缓存中
                    serverStatusCache[suffix] = true;
                }
                // 删除已经不存在的服务器状态
                Array.from(serverRow.children).forEach(serverStatus => {
                    if (!serverStatusCache[serverStatus.id]) {
                        serverRow.removeChild(serverStatus);
                    }
                })
            })
            .catch(error => console.error('Error:', error));
    }
    window.onload = function (){
        updateData();
        setInterval(updateData, 3000)

        if(SHOW_TYPE === 'click'){
            document.onclick = function() {
                Array.from(document.querySelectorAll('.card-body > p:not(:nth-child(1)):not(:nth-child(2)), .card-body > div')).forEach(hideSomeElements)
            };
        }
    }
</script>

</body>
</html>
